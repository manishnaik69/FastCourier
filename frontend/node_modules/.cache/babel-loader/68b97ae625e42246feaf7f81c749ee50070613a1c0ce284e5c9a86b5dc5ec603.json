{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useAuth.js\nimport { useContext } from 'react';\nimport { AuthContext } from '../context/AuthContext';\nexport const useAuth = () => {\n  _s();\n  var _context$user;\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n\n  // Helper functions to work with localStorage\n  const setTokenInStorage = token => {\n    if (token) {\n      localStorage.setItem('token', token);\n    } else {\n      localStorage.removeItem('token');\n    }\n  };\n  const setUserInStorage = user => {\n    if (user) {\n      localStorage.setItem('user', JSON.stringify(user));\n    } else {\n      localStorage.removeItem('user');\n    }\n  };\n\n  // Enhanced auth methods\n  const enhancedLogin = async data => {\n    try {\n      // Store token and user data\n      setTokenInStorage(data.token);\n      setUserInStorage(data.user);\n\n      // Update context\n      if (context.login) {\n        await context.login(data);\n      }\n      return data;\n    } catch (error) {\n      // Clean up storage in case of error\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      throw error;\n    }\n  };\n  const enhancedLogout = () => {\n    // Clear storage\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n\n    // Call context logout\n    if (context.logout) {\n      context.logout();\n    }\n  };\n\n  // Get current auth status\n  const isAuthenticated = !!context.user;\n  const isAdmin = ((_context$user = context.user) === null || _context$user === void 0 ? void 0 : _context$user.isAdmin) || false;\n  return {\n    ...context,\n    login: enhancedLogin,\n    logout: enhancedLogout,\n    isAuthenticated,\n    isAdmin,\n    getToken: () => localStorage.getItem('token'),\n    getUser: () => {\n      const userStr = localStorage.getItem('user');\n      try {\n        return userStr ? JSON.parse(userStr) : null;\n      } catch {\n        return null;\n      }\n    }\n  };\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default useAuth;","map":{"version":3,"names":["useContext","AuthContext","useAuth","_s","_context$user","context","Error","setTokenInStorage","token","localStorage","setItem","removeItem","setUserInStorage","user","JSON","stringify","enhancedLogin","data","login","error","enhancedLogout","logout","isAuthenticated","isAdmin","getToken","getItem","getUser","userStr","parse"],"sources":["C:/Users/Asus/Desktop/cms/manish/manish1/frontend/src/hooks/useAuth.js"],"sourcesContent":["// src/hooks/useAuth.js\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n\r\n  // Helper functions to work with localStorage\r\n  const setTokenInStorage = (token) => {\r\n    if (token) {\r\n      localStorage.setItem('token', token);\r\n    } else {\r\n      localStorage.removeItem('token');\r\n    }\r\n  };\r\n\r\n  const setUserInStorage = (user) => {\r\n    if (user) {\r\n      localStorage.setItem('user', JSON.stringify(user));\r\n    } else {\r\n      localStorage.removeItem('user');\r\n    }\r\n  };\r\n\r\n  // Enhanced auth methods\r\n  const enhancedLogin = async (data) => {\r\n    try {\r\n      // Store token and user data\r\n      setTokenInStorage(data.token);\r\n      setUserInStorage(data.user);\r\n\r\n      // Update context\r\n      if (context.login) {\r\n        await context.login(data);\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      // Clean up storage in case of error\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const enhancedLogout = () => {\r\n    // Clear storage\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n\r\n    // Call context logout\r\n    if (context.logout) {\r\n      context.logout();\r\n    }\r\n  };\r\n\r\n  // Get current auth status\r\n  const isAuthenticated = !!context.user;\r\n  const isAdmin = context.user?.isAdmin || false;\r\n\r\n  return {\r\n    ...context,\r\n    login: enhancedLogin,\r\n    logout: enhancedLogout,\r\n    isAuthenticated,\r\n    isAdmin,\r\n    getToken: () => localStorage.getItem('token'),\r\n    getUser: () => {\r\n      const userStr = localStorage.getItem('user');\r\n      try {\r\n        return userStr ? JSON.parse(userStr) : null;\r\n      } catch {\r\n        return null;\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\nexport default useAuth;"],"mappings":";AAAA;AACA,SAASA,UAAU,QAAQ,OAAO;AAClC,SAASC,WAAW,QAAQ,wBAAwB;AAEpD,OAAO,MAAMC,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAAA,IAAAC,aAAA;EAC3B,MAAMC,OAAO,GAAGL,UAAU,CAACC,WAAW,CAAC;EAEvC,IAAI,CAACI,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,6CAA6C,CAAC;EAChE;;EAEA;EACA,MAAMC,iBAAiB,GAAIC,KAAK,IAAK;IACnC,IAAIA,KAAK,EAAE;MACTC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;IACtC,CAAC,MAAM;MACLC,YAAY,CAACE,UAAU,CAAC,OAAO,CAAC;IAClC;EACF,CAAC;EAED,MAAMC,gBAAgB,GAAIC,IAAI,IAAK;IACjC,IAAIA,IAAI,EAAE;MACRJ,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEI,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC;IACpD,CAAC,MAAM;MACLJ,YAAY,CAACE,UAAU,CAAC,MAAM,CAAC;IACjC;EACF,CAAC;;EAED;EACA,MAAMK,aAAa,GAAG,MAAOC,IAAI,IAAK;IACpC,IAAI;MACF;MACAV,iBAAiB,CAACU,IAAI,CAACT,KAAK,CAAC;MAC7BI,gBAAgB,CAACK,IAAI,CAACJ,IAAI,CAAC;;MAE3B;MACA,IAAIR,OAAO,CAACa,KAAK,EAAE;QACjB,MAAMb,OAAO,CAACa,KAAK,CAACD,IAAI,CAAC;MAC3B;MAEA,OAAOA,IAAI;IACb,CAAC,CAAC,OAAOE,KAAK,EAAE;MACd;MACAV,YAAY,CAACE,UAAU,CAAC,OAAO,CAAC;MAChCF,YAAY,CAACE,UAAU,CAAC,MAAM,CAAC;MAC/B,MAAMQ,KAAK;IACb;EACF,CAAC;EAED,MAAMC,cAAc,GAAGA,CAAA,KAAM;IAC3B;IACAX,YAAY,CAACE,UAAU,CAAC,OAAO,CAAC;IAChCF,YAAY,CAACE,UAAU,CAAC,MAAM,CAAC;;IAE/B;IACA,IAAIN,OAAO,CAACgB,MAAM,EAAE;MAClBhB,OAAO,CAACgB,MAAM,CAAC,CAAC;IAClB;EACF,CAAC;;EAED;EACA,MAAMC,eAAe,GAAG,CAAC,CAACjB,OAAO,CAACQ,IAAI;EACtC,MAAMU,OAAO,GAAG,EAAAnB,aAAA,GAAAC,OAAO,CAACQ,IAAI,cAAAT,aAAA,uBAAZA,aAAA,CAAcmB,OAAO,KAAI,KAAK;EAE9C,OAAO;IACL,GAAGlB,OAAO;IACVa,KAAK,EAAEF,aAAa;IACpBK,MAAM,EAAED,cAAc;IACtBE,eAAe;IACfC,OAAO;IACPC,QAAQ,EAAEA,CAAA,KAAMf,YAAY,CAACgB,OAAO,CAAC,OAAO,CAAC;IAC7CC,OAAO,EAAEA,CAAA,KAAM;MACb,MAAMC,OAAO,GAAGlB,YAAY,CAACgB,OAAO,CAAC,MAAM,CAAC;MAC5C,IAAI;QACF,OAAOE,OAAO,GAAGb,IAAI,CAACc,KAAK,CAACD,OAAO,CAAC,GAAG,IAAI;MAC7C,CAAC,CAAC,MAAM;QACN,OAAO,IAAI;MACb;IACF;EACF,CAAC;AACH,CAAC;AAACxB,EAAA,CA5EWD,OAAO;AA8EpB,eAAeA,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}